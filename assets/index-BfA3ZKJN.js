var me=Object.defineProperty;var fe=(n,t,e)=>t in n?me(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var l=(n,t,e)=>fe(n,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function e(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=e(o);fetch(o.href,s)}})();document.querySelector("div.window");document.querySelector("div.navbar");const W=document.querySelector("div.terminal-content"),x=document.querySelector("ol.terminal-lines"),H=document.querySelector("div.terminal-input"),A=document.querySelector("div.input-feild"),ge=document.querySelector("span.username"),ye=document.querySelector("span.current-directory"),we=document.getElementById("ui-user-input"),be=document.getElementById("ui-notepad");class D extends Error{constructor(e="Node is a file"){super(`NodeIsFileError: ${e}`);l(this,"path");this.path=e,this.name="NodeIsFileError",Object.setPrototypeOf(this,new.target.prototype)}}class v extends Error{constructor(e="Node is a directory"){super(`NodeIsDirectoryError: Node exits with name ${e} in directory.`);l(this,"path");this.path=e,this.name="NodeIsDirectoryError",Object.setPrototypeOf(this,new.target.prototype)}}class F extends Error{constructor(e){super(`NodeWithSameNameExistsError: ${name}`);l(this,"path");this.name="NodeWithSameNameExistsError",this.path=e,Object.setPrototypeOf(this,new.target.prototype)}}class te extends Error{constructor(e){super(`NodeToRemoveIsADirectoryAndNoRecurseFlagIsProvidedError: ${e}`);l(this,"path");this.path=e,this.name="NodeToRemoveIsADirectoryAndNoRecurseFlagIsProvidedError",Object.setPrototypeOf(this,new.target.prototype)}}class re extends Error{constructor(e,r){super(`VariableDoesNotExistsError: ${e}`);l(this,"varName");this.name="VariableDoesNotExistsError",this.varName=r,Object.setPrototypeOf(this,new.target.prototype)}}class ne extends Error{constructor(t){super(`VariableValueLengthError: ${t}`),this.name="VariableValueLengthError",Object.setPrototypeOf(this,new.target.prototype)}}class oe extends Error{constructor(t){super(`CommandStartsWithQuotesError: ${t}`),this.name="CommandStartsWithQuotesError",Object.setPrototypeOf(this,new.target.prototype)}}class se extends Error{constructor(t){super(`TokenContainsQuoteInMiddleErrror: ${t}`),this.name="TokenContainsQuoteInMiddleErrror",Object.setPrototypeOf(this,new.target.prototype)}}class ie extends Error{constructor(t){super(`CommandContainsUnpairedQuoteError: ${t}`),this.name="CommandContainsUnpairedQuoteError",Object.setPrototypeOf(this,new.target.prototype)}}class Ee extends Error{constructor(t){super(`UnexpectedError: ${t}`),this.name="UnexpectedError",Object.setPrototypeOf(this,new.target.prototype)}}class j extends Error{constructor(e){super(`UndefinedCommandError: ${e}`);l(this,"command");this.name="UndefinedCommandError",this.command=e,Object.setPrototypeOf(this,new.target.prototype)}}const V=/\$([^\s]+)/,ve=/\\([^\s])/g;function _e(n){if(xe(n)){if(n.length>3)throw new ne("");return n[2]=Q(n[2]),{type:"variable-assignment",tokens:n}}return n=n.map(Q),n=n.map(t=>t.replace(ve,"$1")),{type:"command",command:n[0].trim(),tokens:n.slice(1)}}function Q(n){const t=n.split($).filter(Boolean);for(let e=0;e<t.length;e++)t[e]=t[e].replace(V,(r,o)=>{const s=p.globals.vars.get(o);if(s===void 0)throw new re(o,o);return s});return t.join($)}function xe(n){const t=!!V.exec(n[0]),e=!!/\=/.exec(n[1]);return t&&e}class y{execute(t,e){try{const r=this.__execute(t);r instanceof Promise?(console.log("is promise"),r.catch(o=>this.handleErrors(o)).finally(()=>e==null?void 0:e())):e==null||e()}catch(r){this.handleErrors(r),e==null||e()}}}class Fe extends Error{constructor(e){super(`InvalidFlagError: ${e}`);l(this,"flagName");this.name="InvalidFlagError",this.flagName=e,Object.setPrototypeOf(this,new.target.prototype)}}class P extends Error{constructor(e){super(`InvalidOptionError: ${e}`);l(this,"optionName");this.optionName=e,this.name="InvalidOptionError",Object.setPrototypeOf(this,new.target.prototype)}}class z extends Error{constructor(e){super(`InvalidColorError: ${e}`);l(this,"color");this.color=e,this.name="InvalidColorError",Object.setPrototypeOf(this,new.target.prototype)}}class Y extends Error{constructor(e){super(`InvalidOperationError: ${e}`);l(this,"operation");this.operation=e,this.name="InvalidOperationError",Object.setPrototypeOf(this,new.target.prototype)}}class N extends Error{constructor(e){super(`InvalidNumberError: ${e}`);l(this,"num");this.num=e,this.name="InvalidNumberError",Object.setPrototypeOf(this,new.target.prototype)}}class f extends Error{constructor(e,r){super();l(this,"expected");l(this,"got");this.expected=e,this.got=r,this.name="IncorrectArgumentsCount",Object.setPrototypeOf(this,new.target.prototype)}}class b extends Error{constructor(e){super(`NodeNotFoundError: ${e}`);l(this,"path");this.path=e,this.name="NodeNotFoundError",Object.setPrototypeOf(this,new.target.prototype)}}class G extends Error{constructor(e){super(`InvalidListItemError: ${e}`);l(this,"itemName");this.itemName=e,this.name="InvalidListItemError",Object.setPrototypeOf(this,new.target.prototype)}}class K extends Error{constructor(e){super(`FunctionNotFoundError: ${e}`);l(this,"funcname");this.name="FunctionNotFoundError",this.funcname=e,Object.setPrototypeOf(this,new.target.prototype)}}function E(n,t){const e=k(n);if(e[0]===ae){const r=t.parent;if(r===null)throw new b("parent");return e.splice(0,1),{root:r,path:e}}else return n[0]===le?(e.splice(0,1),{root:t,path:e}):n.startsWith(p.globals.fs.root.name)?(e.splice(0,1),{root:p.globals.fs.root,path:e}):{root:t,path:e}}function k(n){return n.split("/").filter(Boolean)}function Ne(n){return n.join("/")}const ae="..",le=".";class m{static createDirectory(t,e,r=!1){if(t.type=="file")throw new D(`${t.name} is a file`);if(t.children.some(c=>c.name===e)&&r==!1)throw new F(e);const s={name:e,parent:t,type:"directory",children:[]};return t.children.push(s),s}static createDirectoryByPath(t,e=!1,r){let o,s,c;typeof t=="object"&&"path"in t&&"root"in t?(o=t.root,s=t.path,c=e):(o=e,s=k(t),c=r);let d;for(let h=0;h<s.length;h++){if(d=o.children.findIndex(g=>g.name===s[h]&&g.type==="directory"),d!==-1){if(!c)throw new F(Ne(s.slice(0,h)));o.children.splice(d,1)}o=m.createDirectory(o,s[h],c)}return o}static deleteNodeByPath(t,e,r=!1){const o=this.getNodeByPath(t,e);if(o===void 0)throw new b(t);if(o.type==="directory"&&r==!1)throw new te(t);if(o.parent==null)throw new b("parent");const s=o.parent,c=s.children.findIndex(d=>d.name===o.name);s.children.splice(c,1)}static createFileByPath(t,e,r="",o,s=!1){if(e.type==="file")throw new D(`${e.name} is a file`);const c=typeof t=="string"?E(t,e):t,d=Array.isArray(c.path)?c.path.slice():[...c.path];let h;if(o)h=o;else{if(d.length===0)throw new Error("No file name specified");h=d.pop()}const g=d.length===0?e:this.createDirectoryByPath({path:d,root:e});if(g.type!=="directory")throw new v(h);const T=g.children.some(C=>C.name===h);if(T&&!s)throw new F(h);if(T&&s){const C=g.children.findIndex(he=>he.name===h);C!==-1&&g.children.splice(C,1)}const _={name:h,parent:g,content:r,type:"file"};return g.children.push(_),_}static traverseAndList(t,e=1/0){return typeof t=="object"&&"root"in t&&"path"in t?[t.root.name,...U(t.root,e,0,[])]:[t.name,...U(t,e,0,[])]}static getNodeByPath(t,e){let r,o;return typeof t=="object"&&"path"in t&&"root"in t?(r=Array.isArray(t.path)?t.path:k(t.path),o=t.root):Array.isArray(t)?(r=t,o=e):(r=k(t),o=e),Te(r,o)}static getPathFromNode(t){const e=[];let r=t;for(;r!=null;)e.push(r.name.trim()),r=r==null?void 0:r.parent;return e.reverse().filter(Boolean).join("/")}}function U(n,t,e=0,r){if(e>=t)return r;if(n.type==="file")throw new v(`${n.name} is a file`);const o="|  ".repeat(e)+"|-- ";for(const s of n.children)s.type==="directory"?(r.push(o+s.name),r=U(s,t,e+1,r)):r.push(o+s.name);return r}function Te(n,t){let e=t,r;for(const[o,s]of n.entries()){if(e.type==="file"&&o<=n.length-1||(s===ae?r=e.parent:s===le?r=e:r=e.children.find(c=>c.name===s),!r))return;e=r}return e}class M{static userInputPreview(t){return`
        <li class="line">
          <div class="primary-prompt">
                <span class="username">${p.globals.vars.get("&&username")}</span>
                <span class="current-directory">${m.getPathFromNode(p.globals.fs.currentDirectoryNode)}</span>
          </div>
          <div class="line-content">${t}</div>
        </li>
            `}static standardTerminalOutput(t){return Array.isArray(t)?`<li class="line terminal-output multiline">${t.map(r=>`<div class="line-content">${r}</div>`).join("")}</li>`:`
                <li class="line terminal-output">
                    <div class="line-content">${t}</div>
                </li>
            `}}function ce(){ge.innerText=p.globals.vars.get("&&username")||"USERNAME_NOT_SET",ye.innerText=m.getPathFromNode(p.globals.fs.currentDirectoryNode)}function a(n,t){return Array.isArray(n)?n.map(e=>`<span class="${t}">${e}</span>`):`<span class="${t}">${n}</span>`}const i={black:"#1C1C1C",white:"#FFFFFF",white_off:"#F5F5F5",white_warm:"#FFFBEA",white_silver:"#E6E6E6",red:"#AF5F5F",red_muted:"#AF3F3F",red_bright:"#FF5F5F",red_deep:"#870000",maroon_dark:"#5F1F3F",green_dark:"#5F875F",green_pale:"#87AF87",green_olive:"#6F875F",green_mint:"#AFFF87",green_forest:"#3F5F3F",green_swamp:"#5F8787",green_murky:"#375F4F",yellow_ochre:"#87875F",yellow_light:"#FFFFAF",yellow_deep:"#AFAF5F",yellow_faded:"#D7D787",yellow_mustard:"#5F5F00",blue_light:"#5F87AF",blue_cool:"#8FAFD7",blue_dark:"#005F87",blue_ice:"#AFD7FF",blue_navy:"#1C2A4C",indigo_deep:"#2C2C54",purple_dark:"#5F5F87",purple_muted:"#8787AF",purple_wine:"#875F87",purple_fog:"#D7D7FF",purple_night:"#3F3F5F",teal_bright:"#5FAFAF",teal_dusty:"#5FAF87",teal_light:"#AFFFFF",teal_deep:"#2F4F4F",cyan_steel:"#2B5F5F",orange_warm:"#FF8700",orange_soft:"#FFAF5F",orange_dark:"#D78700",orange_rust:"#AF5F00",brown_dark:"#4B3A2F",grey_faint:"#C0C0C0",grey_cool:"#999999",grey_mid:"#6C6C6C",grey_dark:"#444444",grey_ash:"#3C3C3C",grey_charcoal:"#2B2B2B",grey_coal:"#1A1A1A",slate_deep:"#404860"};function L(){W.scrollTop=W.scrollHeight}class u{static printToTerminal(t){x.innerHTML+=M.standardTerminalOutput(t),L()}static printToTerminalOld(t){x.innerHTML+=t,L()}static clearTerminal(){x.innerHTML=""}static standardErrorOutput(t){x.innerHTML+=M.standardTerminalOutput(t.map(e=>a(e,i.red))),L()}}const S=/^-{1,2}([^\s]+)/;function w(n){const t=[],e={};for(let r=0;r<n.length;r++)if(S.test(n[r]))if(r+1>=n.length||S.test(n[r+1])){const o=S.exec(n[r])[1];t.push(o),n.splice(r,1),r-=1}else{const o=S.exec(n[r])[1];e[o]=n[r+1],n.splice(r,2),r-=2}return{flags:t,options:e,remainingTokens:n}}class Ie extends y{constructor(){super(...arguments);l(this,"name","cd");l(this,"flags",[]);l(this,"options",[])}__execute(e){const r=w(e);if(r.remainingTokens.length!=1)throw new f(1,r.remainingTokens.length);const o=r.remainingTokens[0],s=E(o,p.globals.fs.currentDirectoryNode),c=m.getNodeByPath(s);if(c===void 0)throw new b(o);if(c.type==="file")throw new D(o);p.globals.fs.currentDirectoryNode=c}handleErrors(e){if(e instanceof f){u.standardErrorOutput(["IncorrectArgumentsCountError: This command only takes one argument!","Pass any paths with spaces inside quotations!"]);return}else if(e instanceof b){if(e.path==="parent"){u.standardErrorOutput(["NodeNotFoundError: No parent node exists for this directory !.","Current directory could be the root directory ??"]);return}u.standardErrorOutput([`NodeNotFoundError: Cannot cd into directory, ${a(e.path,i.yellow_light)}, no such path exists!`]);return}else if(e instanceof D){u.standardErrorOutput([`NodeIsFileError: Cannot cd to path, ${a(e.path,i.yellow_light)}, target node is a File!`]);return}else{u.standardErrorOutput([`INVALIDERROR: ${e.name}`,e.toString()]);return}}info(){return["change the current working directory"]}usage(){return["usage: cd <path>","","Arguments:","	<path> -> Path to the target directory. Can be relative, absolute, or special symbols ('.' or '..')","","Path formats supported:",`	 ${a(".",i.yellow_light)} -> Refers to the current directory`,`	 ${a("..",i.yellow_light)} -> Refers to the parent directory`,`	 ${a("root/path/to/dir",i.yellow_light)} -> Absolute path starting from root directory`,`	 ${a("some/nested/dir",i.yellow_light)}-> Relative path from current directory`,"","Examples:",`	 ${a("cd .. ",i.blue_light)} => Moves to the parent directory`,`	 ${a("cd . ",i.blue_light)} => Stays in the current directory`,`	 ${a("cd ./ ",i.blue_light)} => Stays in the current directory`,`	 ${a("cd root/Users/Guest ",i.blue_light)} => Moves to absolute path starting from root`,`	 ${a("cd ./root/a/b",i.blue_light)} => Moves to relative path starting from current directory`,`	 ${a("cd projects/alpha",i.blue_light)} => Moves into a subfolder called 'alpha' inside 'projects'`]}}class Oe extends y{constructor(){super(...arguments);l(this,"name","ls");l(this,"flags",[]);l(this,"options",["d","depth"])}__execute(e){const r=w(e);if(r.remainingTokens.length>=2)throw new f("0 or 1",r.remainingTokens.length);const o=r.remainingTokens[0]||".",s=E(o,p.globals.fs.currentDirectoryNode);let c=r.options.depth||r.options.d||"1";if(c==="inf")c=1/0;else if(c=parseInt(c),!Number.isInteger(c))throw new N(c.toString());const d=m.traverseAndList(s,c);u.printToTerminal(d)}handleErrors(e){e instanceof N?u.standardErrorOutput([`InvalidNumberError: Error in parsing ${a(e.num,i.yellow_light)}. Enter a valid number`]):e instanceof f&&u.standardErrorOutput(["IncorrectArgumentsCountError: This command only takes one argument!","Pass any paths with spaces inside quotations!"])}info(){return["list contents of the current directory"]}usage(){return["usage: ls","","Arguments:","	(none) -> This command does not take any arguments currently.","","Description:","	Lists all files and folders in the current working directory.","	Only the current directory is supported — no paths or flags allowed.","","Examples:",`	${a("ls",i.blue_light)} => Displays all contents of the current directory`]}}class $e extends y{constructor(){super(...arguments);l(this,"name","rm");l(this,"flags",["r"]);l(this,"options",[])}__execute(e){const r=w(e),o=r.flags.includes("r");m.deleteNodeByPath(r.remainingTokens[0],p.globals.fs.currentDirectoryNode,o)}handleErrors(e){e instanceof te?u.standardErrorOutput(["Target node is a directory and no recurse flag was used, skipping delete",`Use ${a("-r",i.blue_light)} flag to remove directories.`]):e instanceof b&&u.standardErrorOutput([`No node found at path ${e.path}`])}info(){return["delete a file or directory from the filesystem"]}usage(){return["usage: rm <path> [flags]","","Arguments:",`	${a("<path>",i.yellow_light)} -> Path to the file or directory to delete.`,"","Flags:",`	${a("-r",i.yellow_light)} -> Recursively deletes a directory and its contents.`,"			   Must be used if the target is a directory.","","Examples:",`	${a("rm hello.txt",i.blue_light)} => Deletes the file 'hello.txt' from the current directory`,`	${a("rm root/data/file.json",i.blue_light)} => Deletes the file at the given absolute path`,`	${a("rm ./projects",i.blue_light)} => Fails if 'projects' is a directory (no -r flag used)`,`	${a("rm ./projects -r",i.blue_light)} => Recursively deletes the 'projects' directory and its contents`]}}class Ce extends y{constructor(){super(...arguments);l(this,"name","cat");l(this,"flags",[]);l(this,"options",[])}__execute(e){const r=w(e);if(r.remainingTokens.length!=1)throw new f(1,r.remainingTokens.length);const o=r.remainingTokens[0].trim(),s=E(o,p.globals.fs.currentDirectoryNode),c=m.getNodeByPath(s);if(c===void 0)throw new b(o);if(c.type==="directory")throw new v(o);const d=c.content;u.printToTerminal(d)}handleErrors(e){e instanceof f?u.standardErrorOutput([`IncorrectArgumentsCountError: This command takes ${e.expected} argument but passed were ${e.got}!`,"Pass any paths with spaces inside quotations!"]):e instanceof v?u.standardErrorOutput([`Cannot show content of node at ${e.path}! Path refers to a directory.`]):e instanceof b&&u.standardErrorOutput([`No node found at path ${e.path}`])}info(){return["print the contents of a file to the terminal"]}usage(){return["usage: cat <path>","","Arguments:","	<path> -> Path to the target file. Can be relative or absolute.","","Path formats supported:",`	${a(".",i.yellow_light)} / ${a("..",i.yellow_light)} -> For self and parent directory traversal`,`	${a("#/path/to/file.txt",i.yellow_light)} -> Absolute path starting from root`,`	${a("some/nested/file.txt",i.yellow_light)} -> Relative path from current directory`,"","Examples:",`	${a("cat hello.txt",i.blue_light)} => Prints contents of 'hello.txt' in the current directory`,`	${a("cat ./docs/readme.md",i.blue_light)} => Prints contents of file at relative path './docs/readme.md'`,`	${a("cat #/files/data.json",i.blue_light)} => Prints contents of absolute path 'root/files/data.json'`]}}function J(n,t=!1,e=!1){return new Promise(r=>{const o=we.content.cloneNode(!0),s=o.querySelector(".ui-user-input-container"),c=o.querySelector(".ui-user-input-feild"),d=o.querySelector(".ui-user-input-prompt");d.innerText=n,c.addEventListener("keypress",function h(g){if(t&&g.key==="Enter"&&g.shiftKey||g.key!=="Enter")return;g.preventDefault();const T=g.target;T.removeEventListener("keypress",h);const _=T.innerText;s.remove(),e==!0&&u.printToTerminal(`${n} : ${_}`),r(_===""?void 0:_)}),x.appendChild(o),c.focus()})}async function Se(){u.printToTerminal("todo"),u.printToTerminal("Hello! This is a browser emulated web terminal !");const n=await J("Setup a username : ")||"sys";u.printToTerminal(`Setup a username : ${n}`),p.globals.vars.set("&&username",n),u.printToTerminal(`Hello ${a(n,i.yellow_light)} !!`);const t=await J("Another user input cuz why not ???????? -> ")||"YOU DIDINT PROVIDE A INPUT 😡😡😡";u.printToTerminal(t)}class ue extends y{constructor(){super(...arguments);l(this,"name","run");l(this,"flags",[]);l(this,"options",[]);l(this,"functionIndex",{setup:Se})}handleErrors(e){e instanceof f?u.standardErrorOutput(["This command only takes one argument! Pass any paths with spaces inside quotations!"]):e instanceof K?u.standardErrorOutput([`No function found with name ${e.funcname}, use ${a("list functions",i.blue_cool)} to view available functions.`]):u.standardErrorOutput(e.name)}async __execute(e){console.log("running");const r=w(e);if(r.remainingTokens.length!=1)throw new f(1,r.remainingTokens.length);const o=r.remainingTokens[0],s=this.functionIndex[o];if(s===void 0)throw new K(o);return await s()}info(){return["Executes a predefined inbuilt script function by name."]}usage(){return[a("usage: run",i.blue_light)+" "+a("<function-name>",i.yellow_light),"",a("Arguments",i.green_pale),"	"+a("<function-name>",i.yellow_light)+"	Name of the inbuilt script function to execute","",a("Examples",i.green_pale),"	"+a("run setup",i.blue_light)+" => runs the internal setup script","","Note:","	Only one argument is allowed. Enclose names with spaces in double quotes.","	Use "+a("list functions",i.blue_light)+" to view all available script functions."]}}class Pe extends y{constructor(){super(...arguments);l(this,"name","list");l(this,"flags",[]);l(this,"options",[]);l(this,"listables",["commands","listables","colors","variables","functions"])}__execute(e){const r=w(e);if(r.remainingTokens.length!=1)throw new f(1,r.remainingTokens.length);const o=r.remainingTokens[0];let s;switch(o){case"commands":s=de.keys().toArray();break;case"listables":{s=this.listables;break}case"variables":{s=p.globals.vars.variables.keys().toArray();break}case"colors":{s=Object.keys(Object(i));break}case"functions":{s=Object.keys(new ue().functionIndex);break}default:throw new G(o)}u.printToTerminal(s)}handleErrors(e){e instanceof G?u.standardErrorOutput([`InvalidListableItemError: The item ${a(e.itemName,i.yellow_light)} is not listable!`,`use ${a("list listables",i.blue_light)} to view all listable items.`]):e instanceof f&&u.standardErrorOutput([`IncorrectArgumentsCountErrror: This command takes atmost 1 arguments, but pass were ${e.got}`])}info(){return["list various internal items like commands, colors, etc."]}usage(){return["usage: list <item>","","Arguments:","	<item> -> Type of content to list. Only specific keywords are accepted.","","Listable items:",`	${a("listables",i.yellow_light)} -> Lists all valid items that can be passed to 'list'`,`	${a("commands",i.yellow_light)} -> Lists all available shell commands`,`	${a("variables",i.yellow_light)} -> Lists all stored variables.`,`	${a("functions",i.yellow_light)} -> Lists all runnable functions.`,"","Examples:",`	${a("list commands",i.blue_light)} => Displays all available commands`,`	${a("list listables",i.blue_light)} => Displays all valid listable categories`]}}class ke extends y{constructor(){super(...arguments);l(this,"name","echo");l(this,"flags",["r","reverse"]);l(this,"options",["colors","l","loop"])}info(){return["display a line of text"]}usage(){return["usage: echo [*args] [flags] [options]","","Flags include:",`	${a("r",i.yellow_light)} -> red color to output string`,`	${a("reverse",i.yellow_light)} -> reverse the output string`,"","Options include:",`	${a("color",i.yellow_light)} : Valid colors - ${Object.values(i).join(", ")}`,`	${a("l | loop",i.yellow_light)} : count - how many times to repeat the output (on newlines)`,"Examples:",'	 echo Hello World "my name is divij"	=> Strings can be quoted, unquoted, or a combination',"	 echo $name '$age'			=> Variables can be in quotations or used directly","	 echo $1 --color red -l 10		=> Uses variable $1, red color, and loops 10 times"]}__execute(e){const r=w(e);let o=r.remainingTokens.join(" ");for(let s of r.flags)switch(s){case"r":{o=a(o,i.red);break}case"reverse":{o=[...o].reverse().join("");break}default:throw new Fe(s)}for(let s in r.options)switch(s){case"color":{const c=r.options.color;if(!(c in i))throw new z(c);o=a(o,c);break}case"l":case"loop":{const c=Number(r.options.l||r.options.loop);if(console.log(c),Number.isNaN(c))throw new N(r.options.l||r.options.loop);o=new Array(c).fill(o);break}default:throw new P(s)}u.printToTerminal(o)}handleErrors(e){if(e instanceof z){u.standardErrorOutput([`InvalidColorError: Color (${e.color}) does not exsists`,`valid colors only include ${Object.values(i).join(", ")}`]);return}else if(e instanceof N){u.standardErrorOutput([`InvalidNumberError: Error in parsing ${a(e.num,i.yellow_light)}. Enter a valid number`]);return}else return}}class Ae extends y{constructor(){super(...arguments);l(this,"name","help");l(this,"flags",["u","usage","i","info"]);l(this,"options",["cmd"])}info(){return["Display information about builtin commands, or used to list all avaialable commands","Options","	--usage | -u	 Shows usage info for provided command "]}usage(){return["help [--cmd] [COMMAND_NAME] [-u | --usage][-i | --info]","eg","	help [--cmd] echo -> info for echo","	help echo --usage -> usage for echo","	help -> lists all avaialable commands"]}__execute(e){const r=w(e);console.log("help");let o;if("cmd"in r.options)console.log("help"),o=r.options.cmd;else{if(r.remainingTokens.length>1)throw new f(1,r.remainingTokens.length);o=r.remainingTokens[0]||"help"}const s=pe(o);if(s==null)throw new j(o);const c=new s;if(console.log(r.flags),r.flags.includes("i")||r.flags.includes("info")){console.log("printing info"),u.printToTerminal([...c.info()]);return}else if(r.flags.includes("u")||r.flags.includes("usage")){u.printToTerminal([...c.usage()]);return}else{u.printToTerminal([...c.info(),...c.usage()]);return}}handleErrors(e){if(e instanceof j){u.standardErrorOutput([`UndefinedCommandError: Command ${a(e.command,i.yellow_light)} does not exsits!`]);return}else e instanceof f?u.standardErrorOutput([`IncorrectArguemntsCountError: Command expects ${a(e.expected.toString(),i.yellow_light)} arguemnts, passed were ${a(e.got.toString(),i.yellow_light)}.`]):u.standardErrorOutput([e.toString()])}}class R{static getUserInput(){return A.innerText}static clearUserInput(){A.innerText=""}}class De extends y{constructor(){super(...arguments);l(this,"name","clear");l(this,"flags",[]);l(this,"options",[])}__execute(e){u.clearTerminal(),R.clearUserInput()}info(){return["clears terminal screen"]}usage(){return["usage: clear"]}handleErrors(e){u.standardErrorOutput(["How even did this command raise an error ???",e.name])}}class je extends y{constructor(){super(...arguments);l(this,"name","mkdir");l(this,"flags",[]);l(this,"options",[])}handleErrors(e){if(e instanceof f){u.standardErrorOutput(["IncorrectArgumentsCountError: This command only takes one argument!","Pass any paths with spaces inside quotations!"]);return}e instanceof F&&u.standardErrorOutput([`NodeWithSameNameExistsError: A directory already exists at path ${a(e.path,i.yellow_light)}.`,`To overwrite existing directory, use the ${a("-f",i.blue_light)} flag.`])}__execute(e){const r=w(e);if(r.remainingTokens.length!=1)throw new f(1,r.remainingTokens.length);const o=E(r.remainingTokens[0],p.globals.fs.currentDirectoryNode);if(m.getNodeByPath(o)!==void 0)throw new F(r.remainingTokens[0]);let c;r.flags.includes("f")?c=m.createDirectoryByPath(o,!0):c=m.createDirectoryByPath(o,!1),(r.flags.includes("c")||r.flags.includes("cd"))&&(p.globals.fs.currentDirectoryNode=c)}info(){return["list contents of a directory with optional depth"]}usage(){return["usage: ls [path] [options]","","Arguments:",`	${a("[path]",i.yellow_light)} -> Optional. Path to the directory to list. Defaults to current directory if omitted.`,"","Options:",`	${a("--depth",i.yellow_light)}, ${a("-d",i.yellow_light)} : Optional. How deep to traverse the directory tree.`,`								  Accepts a number or the keyword ${a("inf",i.yellow_light)}.`,"","Examples:",`	${a("ls",i.blue_light)} => Lists contents of the current directory`,`	${a("ls ./docs",i.blue_light)} => Lists contents of the 'docs' directory`,`	${a("ls -d 2",i.blue_light)} => Lists contents of the current directory up to depth 2`,`	${a("ls root/projects -d inf",i.blue_light)} => Recursively lists everything under 'root/projects'`]}}class Le extends y{constructor(){super(...arguments);l(this,"name","math");l(this,"subcommands",["add","sub","mul","div"]);l(this,"flags",[]);l(this,"options",["out","o"])}info(){return["perform basic arithmetic operations"]}usage(){return["usage: math <subcommand> [*args] [flags] [options]","Subcommands include","	 add -> adds all the given numbers","	 sub -> subtracts subsequent numbers from the first","	 mul -> multiplies all the numbers","	 div -> divides the first number by the second number, takes 2 arguments","Options include","	 -o | --output : assign the result to a variable with the given name","Examples","	 math add 4 5 6 => returns 15","	 math sub 20 5 3 => returns 12","	 math mul 2 3 4 => returns 24","	 math div 100 2 5 => returns 10","	 math add $a $b => supports variable expansion","	 math mul 5 6 -o result => stores result in 'result' variable"]}__execute(e){const r=e.splice(0,1)[0],o=w(e),s=o.remainingTokens.map(d=>{const h=Number(d);if(isNaN(h))throw new N(d);return h});let c;switch(r){case"add":{c=0;for(let d=0;d<s.length;d++)c+=s[d];break}case"sub":{c=0;for(let d=0;d<s.length;d++)c-=s[d];break}case"mul":{c=1;for(let d=0;d<s.length;d++)c*=s[d];break}case"div":{if(s.length>2)throw new f(2,s.length);c=s[0]/s[1];break}default:throw new Y(r)}if("out"in o.options||"o"in o.options){const h=o.options.out||o.options.o||"math_result";p.globals.vars.set(h,c.toString()),u.printToTerminal(`Result saved to var ${a(h,i.yellow_light)}.`);return}else{u.printToTerminal(a(c.toString(),i.yellow_light));return}}handleErrors(e){if(e instanceof N||e.name==="InvalidNumberError"){u.standardErrorOutput([`InvalidNumberError: Error in parsing ${a(e.num,i.yellow_light)}. Enter a valid number`]);return}else e instanceof Y?u.standardErrorOutput([`InvalidOperationError: Operation ${a(e.operation,i.yellow_light)} is unsupported.`,`Valid operations include ${a(this.subcommands.join(", "),i.yellow_light)}.`]):e instanceof f&&u.standardErrorOutput([`IncorrectArguemntsCountError: Command expects ${a(e.expected.toString(),i.yellow_light)} arguemnts, passed were ${a(e.got.toString(),i.yellow_light)}.`])}}class Be extends y{constructor(){super(...arguments);l(this,"name","exit");l(this,"flags",[]);l(this,"options",[])}__execute(e){u.printToTerminal("You can check out any time you like, but you can never leave")}handleErrors(e){}info(){return["Terminates the shell session and exits the CLI environment."]}usage(){return[a("usage: exit",i.blue_light)," ","Example","	"+a("exit",i.blue_light)+" => exits the CLI"]}}let B,O=4,X=" ".repeat(O);const qe=1e3;class q{constructor(t="",e){l(this,"npdWindow");l(this,"npdInput");l(this,"npdSaveCloseButton");l(this,"npdIndentSpacesButton");l(this,"npdIndentSpacesSelect");l(this,"npdIndentSpacesPreview");l(this,"npdFileName");l(this,"resolveInput");l(this,"inserted",!1);l(this,"insertIntoDom",()=>{this.inserted==!1&&(x.appendChild(this.npdWindow),this.inserted=!0)});l(this,"submit",()=>{this.resolveInput!==null&&(this.resolveInput(this.npdInput.value),this.resolveInput=null,this.inserted=!1,this.npdWindow.remove())});l(this,"changeSelection",t=>{const e=t.target;O=Number(e.getAttribute("data-value")),X=$.repeat(O),this.npdIndentSpacesPreview.innerText=O.toString()});l(this,"getContent",()=>(this.insertIntoDom(),new Promise(t=>{this.resolveInput=t})));l(this,"deleteTimeout",()=>{clearTimeout(B)});l(this,"hideWithDelay",()=>{B=setTimeout(()=>{this.npdIndentSpacesSelect.style.display="none"},qe)});l(this,"tab",t=>{if(t.key==="Tab"){console.log("tab"),t.preventDefault();const e=t.target,r=e.selectionStart,o=e.selectionEnd;e.value=e.value.substring(0,r)+X+e.value.substring(o),e.selectionEnd=r+O}});const r=be.content.cloneNode(!0);this.npdWindow=r.querySelector("div.ui-notepad-window"),this.npdInput=r.querySelector("textarea.ui-notepad-inputregion"),this.npdSaveCloseButton=r.querySelector("span.ui-notepad-save-and-close-button"),this.npdIndentSpacesButton=r.querySelector(".ui-notepad-tab-spaces-button"),this.npdIndentSpacesSelect=r.querySelector(".ui-notepad-tab-spaces-select"),this.npdIndentSpacesPreview=r.querySelector("span.selected"),this.npdFileName=r.querySelector("span.ui-notepad-filename"),this.npdFileName.innerText=e,this.resolveInput=null,this.npdInput.addEventListener("keydown",this.tab),this.npdInput.value=t,this.npdIndentSpacesSelect.querySelectorAll(".option").forEach(o=>o.addEventListener("click",this.changeSelection)),this.npdIndentSpacesButton.addEventListener("mouseenter",()=>{clearTimeout(B),this.npdIndentSpacesSelect.style.display="flex"}),this.npdIndentSpacesButton.addEventListener("mouseleave",this.hideWithDelay),this.npdIndentSpacesSelect.addEventListener("mouseover",this.deleteTimeout),this.npdIndentSpacesSelect.addEventListener("mouseleave",this.hideWithDelay),this.npdSaveCloseButton.addEventListener("click",this.submit)}}class Ue extends y{constructor(){super(...arguments);l(this,"name","notepad");l(this,"options",["o","open","n","new"]);l(this,"flags",[])}handleErrors(e){e instanceof v?u.standardErrorOutput([`Cannot open path ${a(e.path,i.yellow_light)}, path refers to a directory!`]):e instanceof P?u.standardErrorOutput([e.optionName==="open"?"No path provided to open!":"No path provided to create a file to!"]):e instanceof f&&u.standardErrorOutput([`Incorrect usage, use ${a("help notepad",i.blue_cool)} for usage.`])}async __execute(e){const r=w(e);let o;if(r.options.o||r.options.open){if(o=r.options.o||r.options.open,!o)throw new P("open");const s=m.getNodeByPath(E(o,p.globals.fs.currentDirectoryNode));if(!s)throw new b(o);if(s.type==="directory")throw new v(o);const c=s,h=await new q(c.content||"",c.name).getContent();c.content=h;return}else if(r.options.n||r.options.new){if(o=r.options.n||r.options.new,!o)throw new P("new");if(m.getNodeByPath(E(o,p.globals.fs.currentDirectoryNode)))throw new F(o);const c=m.createFileByPath(o,p.globals.fs.currentDirectoryNode),h=await new q("",c.name).getContent();c.content=h;return}else{if(r.remainingTokens.length===1){o=r.remainingTokens[0];const s=m.getNodeByPath(E(o,p.globals.fs.currentDirectoryNode));if(!s)throw new b(o);if(s.type==="directory")throw new v(o);const c=s,h=await new q(c.content||"",c.name).getContent();c.content=h;return}throw new f(1,0)}}info(){return["Edit or create a file using the terminal notepad interface."]}usage(){return["usage: notepad (--open <path> | -o <path> | --new <path> | -n <path> | <path>)"," ","Options:",`	${a("o | open",i.yellow_light)} <path>	Open an existing file for editing`,`	${a("n | new",i.yellow_light)} <path>	Create a new file and edit it`," ","Examples:","	 notepad --open foo.txt			Open file named foo.txt","	 notepad -o docs/notes.md		Open a file in a subdirectory","	 notepad --new report.txt		Create a new file named report.txt and edit","	 notepad -n diary/2024-06-05.md	Create new nested file if path allows","	 notepad bar.txt				Open bar.txt (same as --open)"]}}const de=new Map([["cat",Ce],["cd",Ie],["clear",De],["echo",ke],["help",Ae],["math",Le],["mkdir",je],["ls",Oe],["list",Pe],["rm",$e],["run",ue],["exit",Be],["notepad",Ue]]);function pe(n){return de.get(n)}function Me(n,t){if(n.type=="variable-assignment"&&n.tokens){console.log("va "),Re(n.tokens),t==null||t();return}else if(n.type=="command"&&n.command&&n.tokens){const e=pe(n.command);if(e===void 0)throw new j(n.command);new e().execute(n.tokens,t);return}else throw new Ee(n.toString())}function Re(n){const t=V.exec(n[0])[1],e=n[2];p.globals.vars.set(t,e)}function Z(n){return new RegExp(`(?<!\\\\)^[\\'\\"]`).test(n)}function Ve(n){for(let t=1;t<n.length-1;t++){const e=n[t],r=n[t-1];if((e==='"'||e==="'")&&r!=="\\")return!0}return!1}function ee(n){return new RegExp(`(?<!\\\\)[\\'\\"]$`).test(n)}function We(n){let t="",e,r=!0,o=[],s=[];if(Z(n))throw new oe(n);const c=n.split($).filter(Boolean);for(let d=0;d<c.length;d++){if(t=c[d],e==null&&Ve(t))throw new se(t);e==null&&r==!0&&Z(t)?(e=t[0],r=!1,ee(t)&&t.endsWith(e)?(e=void 0,r=!0,o.push(t.slice(1,-1))):s.push(t.slice(1))):e!=null&&r==!1&&ee(t)&&t.endsWith(e)?(e=void 0,r=!0,s.push(t.slice(0,-1)),o.push(s.join($)),s=[]):e!=null&&r==!1?s.push(t):o.push(t)}if(r==!1)throw console.log("unpaired quote"),new ie(n);return o}class He{constructor(t){l(this,"root");l(this,"currentDirectoryNode");this.root=t.initialStructure,this.currentDirectoryNode=this.root}}class Qe{constructor(t){l(this,"variables");this.variables=t||new Map}get(t){return this.variables.get(t)}set(t,e){this.variables.set(t,e.toString())}}class ze{constructor(){l(this,"fs");l(this,"vars");this.fs=new He({initialStructure:{name:"#",type:"directory",parent:null,children:[]}}),this.vars=new Qe}}const $=" ";class Ye{constructor(){l(this,"globals");this.globals=new ze}process(){const t=R.getUserInput();u.printToTerminalOld(M.userInputPreview(t)),R.clearUserInput(),I(!0);let e=[];try{e=We(t)}catch(o){Je(o,t),I(!1);return}let r;try{r=_e(e)}catch(o){Ke(o),I(!1);return}try{Me(r,()=>{I(!1),ce(),A.focus()})}catch(o){Ge(o),I(!1);return}}}function I(n){console.log("hiding",n),n?H.style.display="none":H.style.display="flex"}function Ge(n){n instanceof j&&u.standardErrorOutput([`UndefinedCommandError: Command ${a(n.command,i.yellow_light)} does not exsits!`])}function Ke(n){n instanceof ne||n.name==="VariableValueIsMultipleWords"?u.standardErrorOutput(["VariableValueIsMultipleWords: variables cannot be set values as multiple tokens, pass multiple words in quotations as single token."]):n instanceof re&&u.standardErrorOutput([`VariableDoesNotExistsError: Variable with name ${n.varName} does not exists !`])}function Je(n,t){if(n instanceof oe){u.standardErrorOutput(["TokenizationError: Command starts with quotations",`${a(t,i.yellow_light)}, cannot start with quotations`]);return}else if(n instanceof se){const e=/(?:\w+\s+)?\w+[\'\"]\w+(?:\s+\w+)?/i.exec(t)[0];u.standardErrorOutput(["TokenizationError: Command contains quote in middle",`Error at ${a(e,i.yellow_light)} in command ${t}`]);return}else if(n instanceof ie){u.standardErrorOutput(["TokenizationError: Command contains unpaired quote",a("TODO: BEAUTIFY",i.yellow_light)]);return}else{u.standardErrorOutput(["unexpected error",n]);return}}function Xe(){p.globals.vars.set("ping","pong"),p.globals.vars.set("&&username","divij");const n=m.createDirectoryByPath("/temp/content",p.globals.fs.root,!1),t=m.createDirectoryByPath("/home/",p.globals.fs.root,!1);m.createFileByPath("./info.txt",t.parent,"Linux Bash terminal Emulated purely on browser"),m.createFileByPath("test.txt",n,"Hello World!"),ce()}let p;window.onload=Ze;function Ze(){console.log("starting"),p=new Ye,Xe(),A.addEventListener("keypress",n=>{n.key=="Enter"&&(n.preventDefault(),p.process())})}
