var me=Object.defineProperty;var fe=(r,t,e)=>t in r?me(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var l=(r,t,e)=>fe(r,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function e(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(o){if(o.ep)return;o.ep=!0;const s=e(o);fetch(o.href,s)}})();document.querySelector("div.window");document.querySelector("div.navbar");const W=document.querySelector("div.terminal-content"),x=document.querySelector("ol.terminal-lines"),H=document.querySelector("div.terminal-input"),A=document.querySelector("div.input-feild"),ge=document.querySelector("span.username"),ye=document.querySelector("span.current-directory"),we=document.getElementById("ui-user-input"),be=document.getElementById("ui-notepad");class F extends Error{constructor(e="Node is a file"){super(`NodeIsFileError: ${e}`);l(this,"path");this.path=e,this.name="NodeIsFileError",Object.setPrototypeOf(this,new.target.prototype)}}class _ extends Error{constructor(e="Node is a directory"){super(`NodeIsDirectoryError: Node exits with name ${e} in directory.`);l(this,"path");this.path=e,this.name="NodeIsDirectoryError",Object.setPrototypeOf(this,new.target.prototype)}}class N extends Error{constructor(e){super(`NodeWithSameNameExistsError: ${name}`);l(this,"path");this.name="NodeWithSameNameExistsError",this.path=e,Object.setPrototypeOf(this,new.target.prototype)}}class te extends Error{constructor(e){super(`NodeToRemoveIsADirectoryAndNoRecurseFlagIsProvidedError: ${e}`);l(this,"path");this.path=e,this.name="NodeToRemoveIsADirectoryAndNoRecurseFlagIsProvidedError",Object.setPrototypeOf(this,new.target.prototype)}}class re extends Error{constructor(e,n){super(`VariableDoesNotExistsError: ${e}`);l(this,"varName");this.name="VariableDoesNotExistsError",this.varName=n,Object.setPrototypeOf(this,new.target.prototype)}}class ne extends Error{constructor(t){super(`VariableValueLengthError: ${t}`),this.name="VariableValueLengthError",Object.setPrototypeOf(this,new.target.prototype)}}class oe extends Error{constructor(t){super(`CommandStartsWithQuotesError: ${t}`),this.name="CommandStartsWithQuotesError",Object.setPrototypeOf(this,new.target.prototype)}}class se extends Error{constructor(t){super(`TokenContainsQuoteInMiddleErrror: ${t}`),this.name="TokenContainsQuoteInMiddleErrror",Object.setPrototypeOf(this,new.target.prototype)}}class ie extends Error{constructor(t){super(`CommandContainsUnpairedQuoteError: ${t}`),this.name="CommandContainsUnpairedQuoteError",Object.setPrototypeOf(this,new.target.prototype)}}class Ee extends Error{constructor(t){super(`UnexpectedError: ${t}`),this.name="UnexpectedError",Object.setPrototypeOf(this,new.target.prototype)}}class j extends Error{constructor(e){super(`UndefinedCommandError: ${e}`);l(this,"command");this.name="UndefinedCommandError",this.command=e,Object.setPrototypeOf(this,new.target.prototype)}}const V=/\$([^\s]+)/,_e=/\\([^\s])/g;function ve(r){if(xe(r)){if(r.length>3)throw new ne("");return r[2]=Q(r[2]),{type:"variable-assignment",tokens:r}}return r=r.map(Q),r=r.map(t=>t.replace(_e,"$1")),{type:"command",command:r[0].trim(),tokens:r.slice(1)}}function Q(r){const t=r.split(k).filter(Boolean);for(let e=0;e<t.length;e++)t[e]=t[e].replace(V,(n,o)=>{const s=p.globals.vars.get(o);if(s===void 0)throw new re(o,o);return s});return t.join(k)}function xe(r){const t=!!V.exec(r[0]),e=!!/\=/.exec(r[1]);return t&&e}class y{execute(t,e){try{const n=this.__execute(t);n instanceof Promise?(console.log("is promise"),n.catch(o=>this.handleErrors(o)).finally(()=>e==null?void 0:e())):e==null||e()}catch(n){this.handleErrors(n),e==null||e()}}}class Ne extends Error{constructor(e){super(`InvalidFlagError: ${e}`);l(this,"flagName");this.name="InvalidFlagError",this.flagName=e,Object.setPrototypeOf(this,new.target.prototype)}}class C extends Error{constructor(e){super(`InvalidOptionError: ${e}`);l(this,"optionName");this.optionName=e,this.name="InvalidOptionError",Object.setPrototypeOf(this,new.target.prototype)}}class z extends Error{constructor(e){super(`InvalidColorError: ${e}`);l(this,"color");this.color=e,this.name="InvalidColorError",Object.setPrototypeOf(this,new.target.prototype)}}class Y extends Error{constructor(e){super(`InvalidOperationError: ${e}`);l(this,"operation");this.operation=e,this.name="InvalidOperationError",Object.setPrototypeOf(this,new.target.prototype)}}class T extends Error{constructor(e){super(`InvalidNumberError: ${e}`);l(this,"num");this.num=e,this.name="InvalidNumberError",Object.setPrototypeOf(this,new.target.prototype)}}class f extends Error{constructor(e,n){super();l(this,"expected");l(this,"got");this.expected=e,this.got=n,this.name="IncorrectArgumentsCount",Object.setPrototypeOf(this,new.target.prototype)}}class b extends Error{constructor(e){super(`NodeNotFoundError: ${e}`);l(this,"path");this.path=e,this.name="NodeNotFoundError",Object.setPrototypeOf(this,new.target.prototype)}}class G extends Error{constructor(e){super(`InvalidListItemError: ${e}`);l(this,"itemName");this.itemName=e,this.name="InvalidListItemError",Object.setPrototypeOf(this,new.target.prototype)}}class K extends Error{constructor(e){super(`FunctionNotFoundError: ${e}`);l(this,"funcname");this.name="FunctionNotFoundError",this.funcname=e,Object.setPrototypeOf(this,new.target.prototype)}}function E(r,t){const e=D(r);if(e[0]===ae){const n=t.parent;if(n===null)throw new b("parent");return e.splice(0,1),{root:n,path:e}}else return r[0]===le?(e.splice(0,1),{root:t,path:e}):r.startsWith(p.globals.fs.root.name)?(e.splice(0,1),{root:p.globals.fs.root,path:e}):{root:t,path:e}}function D(r){return r.split("/").filter(Boolean)}function Te(r){return r.join("/")}const ae="..",le=".";class m{static createDirectory(t,e,n=!1){if(t.type=="file")throw new F(`${t.name} is a file`);if(t.children.some(c=>c.name===e)&&n==!1)throw new N(e);const s={name:e,parent:t,type:"directory",children:[]};return t.children.push(s),s}static createDirectoryByPath(t,e=!1,n){let o,s,c;typeof t=="object"&&"path"in t&&"root"in t?(o=t.root,s=t.path,c=e):(o=e,s=D(t),c=n);let d;for(let h=0;h<s.length;h++){if(d=o.children.findIndex(g=>g.name===s[h]&&g.type==="directory"),d!==-1){if(!c)throw new N(Te(s.slice(0,h)));o.children.splice(d,1)}o=m.createDirectory(o,s[h],c)}return o}static deleteNodeByPath(t,e,n=!1){const o=this.getNodeByPath(t,e);if(o===void 0)throw new b(t);if(o.type==="directory"&&n==!1)throw new te(t);if(o.parent==null)throw new b("parent");const s=o.parent,c=s.children.findIndex(d=>d.name===o.name);s.children.splice(c,1)}static createFileByPath(t,e,n="",o,s=!1){if(e.type==="file")throw new F(`${e.name} is a file`);const c=typeof t=="string"?E(t,e):t,d=Array.isArray(c.path)?c.path.slice():[...c.path];let h;if(o)h=o;else{if(d.length===0)throw new Error("No file name specified");h=d.pop()}const g=d.length===0?e:this.createDirectoryByPath({path:d,root:e});if(g.type!=="directory")throw new _(h);const O=g.children.some(S=>S.name===h);if(O&&!s)throw new N(h);if(O&&s){const S=g.children.findIndex(he=>he.name===h);S!==-1&&g.children.splice(S,1)}const v={name:h,parent:g,content:n,type:"file"};return g.children.push(v),v}static traverseAndList(t,e=1/0){return typeof t=="object"&&"root"in t&&"path"in t?[t.root.name,...U(t.root,e,0,[])]:[t.name,...U(t,e,0,[])]}static getNodeByPath(t,e){let n,o;return typeof t=="object"&&"path"in t&&"root"in t?(n=Array.isArray(t.path)?t.path:D(t.path),o=t.root):Array.isArray(t)?(n=t,o=e):(n=D(t),o=e),Oe(n,o)}static getPathFromNode(t){const e=[];let n=t;for(;n!=null;)e.push(n.name.trim()),n=n==null?void 0:n.parent;return e.reverse().filter(Boolean).join("/")}}function U(r,t,e=0,n){if(e>=t)return n;if(r.type==="file")throw new _(`${r.name} is a file`);const o="|  ".repeat(e)+"|-- ";for(const s of r.children)s.type==="directory"?(n.push(o+s.name),n=U(s,t,e+1,n)):n.push(o+s.name);return n}function Oe(r,t){let e=t,n;for(const[o,s]of r.entries()){if(e.type==="file"&&o<=r.length-1||(s===ae?n=e.parent:s===le?n=e:n=e.children.find(c=>c.name===s),!n))return;e=n}return e}class M{static userInputPreview(t){return`
        <li class="line">
          <div class="primary-prompt">
                <span class="username">${p.globals.vars.get("&&username")}</span>
                <span class="current-directory">${m.getPathFromNode(p.globals.fs.currentDirectoryNode)}</span>
          </div>
          <div class="line-content">${t}</div>
        </li>
            `}static standardTerminalOutput(t){return Array.isArray(t)?`<li class="line terminal-output multiline">${t.map(n=>`<div class="line-content">${n}</div>`).join("")}</li>`:`
                <li class="line terminal-output">
                    <div class="line-content">${t}</div>
                </li>
            `}}function ce(){ge.innerText=p.globals.vars.get("&&username")||"USERNAME_NOT_SET",ye.innerText=m.getPathFromNode(p.globals.fs.currentDirectoryNode)}function a(r,t){return Array.isArray(r)?r.map(e=>`<span class="${t}">${e}</span>`):`<span class="${t}">${r}</span>`}const i={black:"black",white:"white",white_off:"white_off",white_warm:"white_warm",white_silver:"white_silver",red:"red",red_muted:"red_muted",red_bright:"red_bright",red_deep:"red_deep",maroon_dark:"maroon_dark",green_dark:"green_dark",green_pale:"green_pale",green_olive:"green_olive",green_mint:"green_mint",green_forest:"green_forest",green_swamp:"green_swamp",green_murky:"green_murky",yellow_ochre:"yellow_ochre",yellow_light:"yellow_light",yellow_deep:"yellow_deep",yellow_faded:"yellow_faded",yellow_mustard:"yellow_mustard",blue_light:"blue_light",blue_cool:"blue_cool",blue_dark:"blue_dark",blue_ice:"blue_ice",blue_navy:"blue_navy",indigo_deep:"indigo_deep",purple_dark:"purple_dark",purple_muted:"purple_muted",purple_wine:"purple_wine",purple_fog:"purple_fog",purple_night:"purple_night",teal_bright:"teal_bright",teal_dusty:"teal_dusty",teal_light:"teal_light",teal_deep:"teal_deep",cyan_steel:"cyan_steel",orange_warm:"orange_warm",orange_soft:"orange_soft",orange_dark:"orange_dark",orange_rust:"orange_rust",brown_dark:"brown_dark",grey_faint:"grey_faint",grey_cool:"grey_cool",grey_mid:"grey_mid",grey_dark:"grey_dark",grey_ash:"grey_ash",grey_charcoal:"grey_charcoal",grey_coal:"grey_coal",slate_deep:"slate_deep"};function L(){W.scrollTop=W.scrollHeight}class u{static printToTerminal(t){x.innerHTML+=M.standardTerminalOutput(t),L()}static printToTerminalOld(t){x.innerHTML+=t,L()}static clearTerminal(){x.innerHTML=""}static standardErrorOutput(t){x.innerHTML+=M.standardTerminalOutput(t.map(e=>a(e,i.red))),L()}}const P=/^-{1,2}([^\s]+)/;function w(r){const t=[],e={};for(let n=0;n<r.length;n++)if(P.test(r[n]))if(n+1>=r.length||P.test(r[n+1])){const o=P.exec(r[n])[1];t.push(o),r.splice(n,1),n-=1}else{const o=P.exec(r[n])[1];e[o]=r[n+1],r.splice(n,2),n-=2}return{flags:t,options:e,remainingTokens:r}}class Ie extends y{constructor(){super(...arguments);l(this,"name","cd");l(this,"flags",[]);l(this,"options",[])}__execute(e){const n=w(e);if(n.remainingTokens.length!=1)throw new f(1,n.remainingTokens.length);const o=n.remainingTokens[0],s=E(o,p.globals.fs.currentDirectoryNode),c=m.getNodeByPath(s);if(c===void 0)throw new b(o);if(c.type==="file")throw new F(o);p.globals.fs.currentDirectoryNode=c}handleErrors(e){if(e instanceof f){u.standardErrorOutput(["IncorrectArgumentsCountError: This command only takes one argument!","Pass any paths with spaces inside quotations!"]);return}else if(e instanceof b){if(e.path==="parent"){u.standardErrorOutput(["NodeNotFoundError: No parent node exists for this directory !.","Current directory could be the root directory ??"]);return}u.standardErrorOutput([`NodeNotFoundError: Cannot cd into directory, ${a(e.path,i.yellow_light)}, no such path exists!`]);return}else if(e instanceof F){u.standardErrorOutput([`NodeIsFileError: Cannot cd to path, ${a(e.path,i.yellow_light)}, target node is a File!`]);return}else{u.standardErrorOutput([`INVALIDERROR: ${e.name}`,e.toString()]);return}}info(){return["change the current working directory"]}usage(){return["usage: cd <path>","","Arguments:","	<path> -> Path to the target directory. Can be relative, absolute, or special symbols ('.' or '..')","","Path formats supported:",`	 ${a(".",i.yellow_light)} -> Refers to the current directory`,`	 ${a("..",i.yellow_light)} -> Refers to the parent directory`,`	 ${a("root/path/to/dir",i.yellow_light)} -> Absolute path starting from root directory`,`	 ${a("some/nested/dir",i.yellow_light)}-> Relative path from current directory`,"","Examples:",`	 ${a("cd .. ",i.blue_light)} => Moves to the parent directory`,`	 ${a("cd . ",i.blue_light)} => Stays in the current directory`,`	 ${a("cd ./ ",i.blue_light)} => Stays in the current directory`,`	 ${a("cd root/Users/Guest ",i.blue_light)} => Moves to absolute path starting from root`,`	 ${a("cd ./root/a/b",i.blue_light)} => Moves to relative path starting from current directory`,`	 ${a("cd projects/alpha",i.blue_light)} => Moves into a subfolder called 'alpha' inside 'projects'`]}}class $e extends y{constructor(){super(...arguments);l(this,"name","ls");l(this,"flags",[]);l(this,"options",["d","depth"])}__execute(e){const n=w(e);if(n.remainingTokens.length>=2)throw new f("0 or 1",n.remainingTokens.length);const o=n.remainingTokens[0]||".",s=E(o,p.globals.fs.currentDirectoryNode);let c=n.options.depth||n.options.d||"1";if(c==="inf")c=1/0;else if(c=parseInt(c),!Number.isInteger(c))throw new T(c.toString());const d=m.traverseAndList(s,c);u.printToTerminal(d)}handleErrors(e){e instanceof T?u.standardErrorOutput([`InvalidNumberError: Error in parsing ${a(e.num,i.yellow_light)}. Enter a valid number`]):e instanceof f&&u.standardErrorOutput(["IncorrectArgumentsCountError: This command only takes one argument!","Pass any paths with spaces inside quotations!"])}info(){return["list contents of the current directory"]}usage(){return["usage: ls","","Arguments:","	(none) -> This command does not take any arguments currently.","","Description:","	Lists all files and folders in the current working directory.","	Only the current directory is supported — no paths or flags allowed.","","Examples:",`	${a("ls",i.blue_light)} => Displays all contents of the current directory`]}}class ke extends y{constructor(){super(...arguments);l(this,"name","rm");l(this,"flags",["r"]);l(this,"options",[])}__execute(e){const n=w(e),o=n.flags.includes("r");m.deleteNodeByPath(n.remainingTokens[0],p.globals.fs.currentDirectoryNode,o)}handleErrors(e){e instanceof te?u.standardErrorOutput(["Target node is a directory and no recurse flag was used, skipping delete",`Use ${a("-r",i.blue_light)} flag to remove directories.`]):e instanceof b&&u.standardErrorOutput([`No node found at path ${e.path}`])}info(){return["delete a file or directory from the filesystem"]}usage(){return["usage: rm <path> [flags]","","Arguments:",`	${a("<path>",i.yellow_light)} -> Path to the file or directory to delete.`,"","Flags:",`	${a("-r",i.yellow_light)} -> Recursively deletes a directory and its contents.`,"			   Must be used if the target is a directory.","","Examples:",`	${a("rm hello.txt",i.blue_light)} => Deletes the file 'hello.txt' from the current directory`,`	${a("rm root/data/file.json",i.blue_light)} => Deletes the file at the given absolute path`,`	${a("rm ./projects",i.blue_light)} => Fails if 'projects' is a directory (no -r flag used)`,`	${a("rm ./projects -r",i.blue_light)} => Recursively deletes the 'projects' directory and its contents`]}}class Se extends y{constructor(){super(...arguments);l(this,"name","cat");l(this,"flags",[]);l(this,"options",[])}__execute(e){const n=w(e);if(n.remainingTokens.length!=1)throw new f(1,n.remainingTokens.length);const o=n.remainingTokens[0].trim(),s=E(o,p.globals.fs.currentDirectoryNode),c=m.getNodeByPath(s);if(c===void 0)throw new b(o);if(c.type==="directory")throw new _(o);const d=c.content;u.printToTerminal(d)}handleErrors(e){e instanceof f?u.standardErrorOutput([`IncorrectArgumentsCountError: This command takes ${e.expected} argument but passed were ${e.got}!`,"Pass any paths with spaces inside quotations!"]):e instanceof _?u.standardErrorOutput([`Cannot show content of node at ${e.path}! Path refers to a directory.`]):e instanceof b&&u.standardErrorOutput([`No node found at path ${e.path}`])}info(){return["print the contents of a file to the terminal"]}usage(){return["usage: cat <path>","","Arguments:","	<path> -> Path to the target file. Can be relative or absolute.","","Path formats supported:",`	${a(".",i.yellow_light)} / ${a("..",i.yellow_light)} -> For self and parent directory traversal`,`	${a("#/path/to/file.txt",i.yellow_light)} -> Absolute path starting from root`,`	${a("some/nested/file.txt",i.yellow_light)} -> Relative path from current directory`,"","Examples:",`	${a("cat hello.txt",i.blue_light)} => Prints contents of 'hello.txt' in the current directory`,`	${a("cat ./docs/readme.md",i.blue_light)} => Prints contents of file at relative path './docs/readme.md'`,`	${a("cat #/files/data.json",i.blue_light)} => Prints contents of absolute path 'root/files/data.json'`]}}function J(r,t=!1,e=!1){return new Promise(n=>{const o=we.content.cloneNode(!0),s=o.querySelector(".ui-user-input-container"),c=o.querySelector(".ui-user-input-feild"),d=o.querySelector(".ui-user-input-prompt");d.innerText=r,c.addEventListener("keypress",function h(g){if(t&&g.key==="Enter"&&g.shiftKey||g.key!=="Enter")return;g.preventDefault();const O=g.target;O.removeEventListener("keypress",h);const v=O.innerText;s.remove(),e==!0&&u.printToTerminal(`${r} : ${v}`),n(v===""?void 0:v)}),x.appendChild(o),c.focus()})}async function Pe(){u.printToTerminal("todo"),u.printToTerminal("Hello! This is a browser emulated web terminal !");const r=await J("Setup a username : ")||"sys";u.printToTerminal(`Setup a username : ${r}`),p.globals.vars.set("&&username",r),u.printToTerminal(`Hello ${a(r,i.yellow_light)} !!`);const t=await J("Another user input cuz why not ???????? -> ")||"YOU DIDINT PROVIDE A INPUT 😡😡😡";u.printToTerminal(t)}class ue extends y{constructor(){super(...arguments);l(this,"name","run");l(this,"flags",[]);l(this,"options",[]);l(this,"functionIndex",{setup:Pe})}handleErrors(e){e instanceof f?u.standardErrorOutput(["This command only takes one argument! Pass any paths with spaces inside quotations!"]):e instanceof K?u.standardErrorOutput([`No function found with name ${e.funcname}, use ${a("list functions",i.blue_cool)} to view available functions.`]):u.standardErrorOutput(e.name)}async __execute(e){console.log("running");const n=w(e);if(n.remainingTokens.length!=1)throw new f(1,n.remainingTokens.length);const o=n.remainingTokens[0],s=this.functionIndex[o];if(s===void 0)throw new K(o);return await s()}info(){return["Executes a predefined inbuilt script function by name."]}usage(){return[a("usage: run",i.blue_light)+" "+a("<function-name>",i.yellow_light),"",a("Arguments",i.green_pale),"	"+a("<function-name>",i.yellow_light)+"	Name of the inbuilt script function to execute","",a("Examples",i.green_pale),"	"+a("run setup",i.blue_light)+" => runs the internal setup script","","Note:","	Only one argument is allowed. Enclose names with spaces in double quotes.","	Use "+a("list functions",i.blue_light)+" to view all available script functions."]}}class Ce extends y{constructor(){super(...arguments);l(this,"name","list");l(this,"flags",[]);l(this,"options",[]);l(this,"listables",["commands","listables","colors","variables","functions"])}__execute(e){const n=w(e);if(n.remainingTokens.length!=1)throw new f(1,n.remainingTokens.length);const o=n.remainingTokens[0];let s;switch(o){case"commands":s=de.keys().toArray();break;case"listables":{s=this.listables;break}case"variables":{s=p.globals.vars.variables.keys().toArray();break}case"colors":{s=Object.keys(Object(i));break}case"functions":{s=Object.keys(new ue().functionIndex);break}default:throw new G(o)}u.printToTerminal(s)}handleErrors(e){e instanceof G?u.standardErrorOutput([`InvalidListableItemError: The item ${a(e.itemName,i.yellow_light)} is not listable!`,`use ${a("list listables",i.blue_light)} to view all listable items.`]):e instanceof f&&u.standardErrorOutput([`IncorrectArgumentsCountErrror: This command takes atmost 1 arguments, but pass were ${e.got}`])}info(){return["list various internal items like commands, colors, etc."]}usage(){return["usage: list <item>","","Arguments:","	<item> -> Type of content to list. Only specific keywords are accepted.","","Listable items:",`	${a("listables",i.yellow_light)} -> Lists all valid items that can be passed to 'list'`,`	${a("commands",i.yellow_light)} -> Lists all available shell commands`,`	${a("variables",i.yellow_light)} -> Lists all stored variables.`,`	${a("functions",i.yellow_light)} -> Lists all runnable functions.`,"","Examples:",`	${a("list commands",i.blue_light)} => Displays all available commands`,`	${a("list listables",i.blue_light)} => Displays all valid listable categories`]}}class De extends y{constructor(){super(...arguments);l(this,"name","echo");l(this,"flags",["r","reverse"]);l(this,"options",["colors","l","loop"])}info(){return["display a line of text"]}usage(){return["usage: echo [*args] [flags] [options]","","Flags include:",`	${a("r",i.yellow_light)} -> red color to output string`,`	${a("reverse",i.yellow_light)} -> reverse the output string`,"","Options include:",`	${a("color",i.yellow_light)} : Valid colors - ${Object.values(i).join(", ")}`,`	${a("l | loop",i.yellow_light)} : count - how many times to repeat the output (on newlines)`,"Examples:",'	 echo Hello World "my name is divij"	=> Strings can be quoted, unquoted, or a combination',"	 echo $name '$age'			=> Variables can be in quotations or used directly","	 echo $1 --color red -l 10		=> Uses variable $1, red color, and loops 10 times"]}__execute(e){const n=w(e);let o=n.remainingTokens.join(" ");for(let s of n.flags)switch(s){case"r":{o=a(o,i.red);break}case"reverse":{o=[...o].reverse().join("");break}default:throw new Ne(s)}for(let s in n.options)switch(s){case"color":{const c=n.options.color;if(!(c in i))throw new z(c);o=a(o,c);break}case"l":case"loop":{const c=Number(n.options.l||n.options.loop);if(console.log(c),Number.isNaN(c))throw new T(n.options.l||n.options.loop);o=new Array(c).fill(o);break}default:throw new C(s)}u.printToTerminal(o)}handleErrors(e){if(e instanceof z){u.standardErrorOutput([`InvalidColorError: Color (${e.color}) does not exsists`,`valid colors only include ${Object.values(i).join(", ")}`]);return}else if(e instanceof T){u.standardErrorOutput([`InvalidNumberError: Error in parsing ${a(e.num,i.yellow_light)}. Enter a valid number`]);return}else return}}class Ae extends y{constructor(){super(...arguments);l(this,"name","help");l(this,"flags",["u","usage","i","info"]);l(this,"options",["cmd"])}info(){return["Display information about builtin commands, or used to list all avaialable commands","Options","	--usage | -u	 Shows usage info for provided command "]}usage(){return["help [--cmd] [COMMAND_NAME] [-u | --usage][-i | --info]","eg","	help [--cmd] echo -> info for echo","	help echo --usage -> usage for echo","	help -> lists all avaialable commands"]}__execute(e){const n=w(e);console.log("help");let o;if("cmd"in n.options)console.log("help"),o=n.options.cmd;else{if(n.remainingTokens.length>1)throw new f(1,n.remainingTokens.length);o=n.remainingTokens[0]||"help"}const s=pe(o);if(s==null)throw new j(o);const c=new s;if(console.log(n.flags),n.flags.includes("i")||n.flags.includes("info")){console.log("printing info"),u.printToTerminal([...c.info()]);return}else if(n.flags.includes("u")||n.flags.includes("usage")){u.printToTerminal([...c.usage()]);return}else{u.printToTerminal([...c.info(),...c.usage()]);return}}handleErrors(e){if(e instanceof j){u.standardErrorOutput([`UndefinedCommandError: Command ${a(e.command,i.yellow_light)} does not exsits!`]);return}else e instanceof f?u.standardErrorOutput([`IncorrectArguemntsCountError: Command expects ${a(e.expected.toString(),i.yellow_light)} arguemnts, passed were ${a(e.got.toString(),i.yellow_light)}.`]):u.standardErrorOutput([e.toString()])}}class R{static getUserInput(){return A.innerText}static clearUserInput(){A.innerText=""}}class Fe extends y{constructor(){super(...arguments);l(this,"name","clear");l(this,"flags",[]);l(this,"options",[])}__execute(e){u.clearTerminal(),R.clearUserInput()}info(){return["clears terminal screen"]}usage(){return["usage: clear"]}handleErrors(e){u.standardErrorOutput(["How even did this command raise an error ???",e.name])}}class je extends y{constructor(){super(...arguments);l(this,"name","mkdir");l(this,"flags",[]);l(this,"options",[])}handleErrors(e){if(e instanceof f){u.standardErrorOutput(["IncorrectArgumentsCountError: This command only takes one argument!","Pass any paths with spaces inside quotations!"]);return}e instanceof N&&u.standardErrorOutput([`NodeWithSameNameExistsError: A directory already exists at path ${a(e.path,i.yellow_light)}.`,`To overwrite existing directory, use the ${a("-f",i.blue_light)} flag.`])}__execute(e){const n=w(e);if(n.remainingTokens.length!=1)throw new f(1,n.remainingTokens.length);const o=E(n.remainingTokens[0],p.globals.fs.currentDirectoryNode);if(m.getNodeByPath(o)!==void 0)throw new N(n.remainingTokens[0]);let c;n.flags.includes("f")?c=m.createDirectoryByPath(o,!0):c=m.createDirectoryByPath(o,!1),(n.flags.includes("c")||n.flags.includes("cd"))&&(p.globals.fs.currentDirectoryNode=c)}info(){return["list contents of a directory with optional depth"]}usage(){return["usage: ls [path] [options]","","Arguments:",`	${a("[path]",i.yellow_light)} -> Optional. Path to the directory to list. Defaults to current directory if omitted.`,"","Options:",`	${a("--depth",i.yellow_light)}, ${a("-d",i.yellow_light)} : Optional. How deep to traverse the directory tree.`,`								  Accepts a number or the keyword ${a("inf",i.yellow_light)}.`,"","Examples:",`	${a("ls",i.blue_light)} => Lists contents of the current directory`,`	${a("ls ./docs",i.blue_light)} => Lists contents of the 'docs' directory`,`	${a("ls -d 2",i.blue_light)} => Lists contents of the current directory up to depth 2`,`	${a("ls root/projects -d inf",i.blue_light)} => Recursively lists everything under 'root/projects'`]}}class Le extends y{constructor(){super(...arguments);l(this,"name","math");l(this,"subcommands",["add","sub","mul","div"]);l(this,"flags",[]);l(this,"options",["out","o"])}info(){return["perform basic arithmetic operations"]}usage(){return["usage: math <subcommand> [*args] [flags] [options]","Subcommands include","	 add -> adds all the given numbers","	 sub -> subtracts subsequent numbers from the first","	 mul -> multiplies all the numbers","	 div -> divides the first number by the second number, takes 2 arguments","Options include","	 -o | --output : assign the result to a variable with the given name","Examples","	 math add 4 5 6 => returns 15","	 math sub 20 5 3 => returns 12","	 math mul 2 3 4 => returns 24","	 math div 100 2 5 => returns 10","	 math add $a $b => supports variable expansion","	 math mul 5 6 -o result => stores result in 'result' variable"]}__execute(e){const n=e.splice(0,1)[0],o=w(e),s=o.remainingTokens.map(d=>{const h=Number(d);if(isNaN(h))throw new T(d);return h});let c;switch(n){case"add":{c=0;for(let d=0;d<s.length;d++)c+=s[d];break}case"sub":{c=0;for(let d=0;d<s.length;d++)c-=s[d];break}case"mul":{c=1;for(let d=0;d<s.length;d++)c*=s[d];break}case"div":{if(s.length>2)throw new f(2,s.length);c=s[0]/s[1];break}default:throw new Y(n)}if("out"in o.options||"o"in o.options){const h=o.options.out||o.options.o||"math_result";p.globals.vars.set(h,c.toString()),u.printToTerminal(`Result saved to var ${a(h,i.yellow_light)}.`);return}else{u.printToTerminal(a(c.toString(),i.yellow_light));return}}handleErrors(e){if(e instanceof T||e.name==="InvalidNumberError"){u.standardErrorOutput([`InvalidNumberError: Error in parsing ${a(e.num,i.yellow_light)}. Enter a valid number`]);return}else e instanceof Y?u.standardErrorOutput([`InvalidOperationError: Operation ${a(e.operation,i.yellow_light)} is unsupported.`,`Valid operations include ${a(this.subcommands.join(", "),i.yellow_light)}.`]):e instanceof f&&u.standardErrorOutput([`IncorrectArguemntsCountError: Command expects ${a(e.expected.toString(),i.yellow_light)} arguemnts, passed were ${a(e.got.toString(),i.yellow_light)}.`])}}class Be extends y{constructor(){super(...arguments);l(this,"name","exit");l(this,"flags",[]);l(this,"options",[])}__execute(e){u.printToTerminal("You can check out any time you like, but you can never leave")}handleErrors(e){}info(){return["Terminates the shell session and exits the CLI environment."]}usage(){return[a("usage: exit",i.blue_light)," ","Example","	"+a("exit",i.blue_light)+" => exits the CLI"]}}let B,$=4,X=" ".repeat($);const qe=1e3;class q{constructor(t="",e){l(this,"npdWindow");l(this,"npdInput");l(this,"npdSaveCloseButton");l(this,"npdIndentSpacesButton");l(this,"npdIndentSpacesSelect");l(this,"npdIndentSpacesPreview");l(this,"npdFileName");l(this,"resolveInput");l(this,"inserted",!1);l(this,"insertIntoDom",()=>{this.inserted==!1&&(x.appendChild(this.npdWindow),this.inserted=!0)});l(this,"submit",()=>{this.resolveInput!==null&&(this.resolveInput(this.npdInput.value),this.resolveInput=null,this.inserted=!1,this.npdWindow.remove())});l(this,"changeSelection",t=>{const e=t.target;$=Number(e.getAttribute("data-value")),X=k.repeat($),this.npdIndentSpacesPreview.innerText=$.toString()});l(this,"getContent",()=>(this.insertIntoDom(),new Promise(t=>{this.resolveInput=t})));l(this,"deleteTimeout",()=>{clearTimeout(B)});l(this,"hideWithDelay",()=>{B=setTimeout(()=>{this.npdIndentSpacesSelect.style.display="none"},qe)});l(this,"tab",t=>{if(t.key==="Tab"){console.log("tab"),t.preventDefault();const e=t.target,n=e.selectionStart,o=e.selectionEnd;e.value=e.value.substring(0,n)+X+e.value.substring(o),e.selectionEnd=n+$}});const n=be.content.cloneNode(!0);this.npdWindow=n.querySelector("div.ui-notepad-window"),this.npdInput=n.querySelector("textarea.ui-notepad-inputregion"),this.npdSaveCloseButton=n.querySelector("span.ui-notepad-save-and-close-button"),this.npdIndentSpacesButton=n.querySelector(".ui-notepad-tab-spaces-button"),this.npdIndentSpacesSelect=n.querySelector(".ui-notepad-tab-spaces-select"),this.npdIndentSpacesPreview=n.querySelector("span.selected"),this.npdFileName=n.querySelector("span.ui-notepad-filename"),this.npdFileName.innerText=e,this.resolveInput=null,this.npdInput.addEventListener("keydown",this.tab),this.npdInput.value=t,this.npdIndentSpacesSelect.querySelectorAll(".option").forEach(o=>o.addEventListener("click",this.changeSelection)),this.npdIndentSpacesButton.addEventListener("mouseenter",()=>{clearTimeout(B),this.npdIndentSpacesSelect.style.display="flex"}),this.npdIndentSpacesButton.addEventListener("mouseleave",this.hideWithDelay),this.npdIndentSpacesSelect.addEventListener("mouseover",this.deleteTimeout),this.npdIndentSpacesSelect.addEventListener("mouseleave",this.hideWithDelay),this.npdSaveCloseButton.addEventListener("click",this.submit)}}class Ue extends y{constructor(){super(...arguments);l(this,"name","notepad");l(this,"options",["o","open","n","new"]);l(this,"flags",[])}handleErrors(e){e instanceof _?u.standardErrorOutput([`Cannot open path ${a(e.path,i.yellow_light)}, path refers to a directory!`]):e instanceof C?u.standardErrorOutput([e.optionName==="open"?"No path provided to open!":"No path provided to create a file to!"]):e instanceof f&&u.standardErrorOutput([`Incorrect usage, use ${a("help notepad",i.blue_cool)} for usage.`])}async __execute(e){const n=w(e);let o;if(n.options.o||n.options.open){if(o=n.options.o||n.options.open,!o)throw new C("open");const s=m.getNodeByPath(E(o,p.globals.fs.currentDirectoryNode));if(!s)throw new b(o);if(s.type==="directory")throw new _(o);const c=s,h=await new q(c.content||"",c.name).getContent();c.content=h;return}else if(n.options.n||n.options.new){if(o=n.options.n||n.options.new,!o)throw new C("new");if(m.getNodeByPath(E(o,p.globals.fs.currentDirectoryNode)))throw new N(o);const c=m.createFileByPath(o,p.globals.fs.currentDirectoryNode),h=await new q("",c.name).getContent();c.content=h;return}else{if(n.remainingTokens.length===1){o=n.remainingTokens[0];const s=m.getNodeByPath(E(o,p.globals.fs.currentDirectoryNode));if(!s)throw new b(o);if(s.type==="directory")throw new _(o);const c=s,h=await new q(c.content||"",c.name).getContent();c.content=h;return}throw new f(1,0)}}info(){return["Edit or create a file using the terminal notepad interface."]}usage(){return["usage: notepad (--open <path> | -o <path> | --new <path> | -n <path> | <path>)"," ","Options:",`	${a("o | open",i.yellow_light)} <path>	Open an existing file for editing`,`	${a("n | new",i.yellow_light)} <path>	Create a new file and edit it`," ","Examples:","	 notepad --open foo.txt			Open file named foo.txt","	 notepad -o docs/notes.md		Open a file in a subdirectory","	 notepad --new report.txt		Create a new file named report.txt and edit","	 notepad -n diary/2024-06-05.md	Create new nested file if path allows","	 notepad bar.txt				Open bar.txt (same as --open)"]}}const de=new Map([["cat",Se],["cd",Ie],["clear",Fe],["echo",De],["help",Ae],["math",Le],["mkdir",je],["ls",$e],["list",Ce],["rm",ke],["run",ue],["exit",Be],["notepad",Ue]]);function pe(r){return de.get(r)}function Me(r,t){if(r.type=="variable-assignment"&&r.tokens){console.log("va "),Re(r.tokens),t==null||t();return}else if(r.type=="command"&&r.command&&r.tokens){const e=pe(r.command);if(e===void 0)throw new j(r.command);new e().execute(r.tokens,t);return}else throw new Ee(r.toString())}function Re(r){const t=V.exec(r[0])[1],e=r[2];p.globals.vars.set(t,e)}function Z(r){return new RegExp(`(?<!\\\\)^[\\'\\"]`).test(r)}function Ve(r){for(let t=1;t<r.length-1;t++){const e=r[t],n=r[t-1];if((e==='"'||e==="'")&&n!=="\\")return!0}return!1}function ee(r){return new RegExp(`(?<!\\\\)[\\'\\"]$`).test(r)}function We(r){let t="",e,n=!0,o=[],s=[];if(Z(r))throw new oe(r);const c=r.split(k).filter(Boolean);for(let d=0;d<c.length;d++){if(t=c[d],e==null&&Ve(t))throw new se(t);e==null&&n==!0&&Z(t)?(e=t[0],n=!1,ee(t)&&t.endsWith(e)?(e=void 0,n=!0,o.push(t.slice(1,-1))):s.push(t.slice(1))):e!=null&&n==!1&&ee(t)&&t.endsWith(e)?(e=void 0,n=!0,s.push(t.slice(0,-1)),o.push(s.join(k)),s=[]):e!=null&&n==!1?s.push(t):o.push(t)}if(n==!1)throw console.log("unpaired quote"),new ie(r);return o}class He{constructor(t){l(this,"root");l(this,"currentDirectoryNode");this.root=t.initialStructure,this.currentDirectoryNode=this.root}}class Qe{constructor(t){l(this,"variables");this.variables=t||new Map}get(t){return this.variables.get(t)}set(t,e){this.variables.set(t,e.toString())}}class ze{constructor(){l(this,"fs");l(this,"vars");this.fs=new He({initialStructure:{name:"#",type:"directory",parent:null,children:[]}}),this.vars=new Qe}}const k=" ";class Ye{constructor(){l(this,"globals");this.globals=new ze}process(){const t=R.getUserInput();u.printToTerminalOld(M.userInputPreview(t)),R.clearUserInput(),I(!0);let e=[];try{e=We(t)}catch(o){Je(o,t),I(!1);return}let n;try{n=ve(e)}catch(o){Ke(o),I(!1);return}try{Me(n,()=>{I(!1),ce(),A.focus()})}catch(o){Ge(o),I(!1);return}}}function I(r){console.log("hiding",r),r?H.style.display="none":H.style.display="flex"}function Ge(r){r instanceof j&&u.standardErrorOutput([`UndefinedCommandError: Command ${a(r.command,i.yellow_light)} does not exsits!`])}function Ke(r){r instanceof ne||r.name==="VariableValueIsMultipleWords"?u.standardErrorOutput(["VariableValueIsMultipleWords: variables cannot be set values as multiple tokens, pass multiple words in quotations as single token."]):r instanceof re&&u.standardErrorOutput([`VariableDoesNotExistsError: Variable with name ${r.varName} does not exists !`])}function Je(r,t){if(r instanceof oe){u.standardErrorOutput(["TokenizationError: Command starts with quotations",`${a(t,i.yellow_light)}, cannot start with quotations`]);return}else if(r instanceof se){const e=/(?:\w+\s+)?\w+[\'\"]\w+(?:\s+\w+)?/i.exec(t)[0];u.standardErrorOutput(["TokenizationError: Command contains quote in middle",`Error at ${a(e,i.yellow_light)} in command ${t}`]);return}else if(r instanceof ie){u.standardErrorOutput(["TokenizationError: Command contains unpaired quote",a("TODO: BEAUTIFY",i.yellow_light)]);return}else{u.standardErrorOutput(["unexpected error",r]);return}}function Xe(){p.globals.vars.set("ping","pong"),p.globals.vars.set("&&username",`guest@${Ze()}`);const r=m.createDirectoryByPath("/temp/content",p.globals.fs.root,!1),t=m.createDirectoryByPath("/home/",p.globals.fs.root,!1);m.createFileByPath("./info.txt",t.parent,"Linux Bash terminal Emulated purely on browser"),m.createFileByPath("test.txt",r,"Hello World!"),ce()}function Ze(){var r=navigator.userAgent;return r.indexOf("Edg")>-1?"MicrosoftEdge":r.indexOf("Chrome")>-1?"Chrome":r.indexOf("Firefox")>-1?"Firefox":r.indexOf("Safari")>-1?"Safari":r.indexOf("Opera")>-1?"Opera":r.indexOf("Trident")>-1||r.indexOf("MSIE")>-1?"InternetExplorer":"UnknownBrowser"}let p;window.onload=et;function et(){console.log("starting"),p=new Ye,Xe(),A.addEventListener("keypress",r=>{r.key=="Enter"&&(r.preventDefault(),p.process())})}
